"use strict";Object.defineProperty(exports, "__esModule", {value: true});function a({name:t,permissions:T,roles:i}){return{name:t,permissions:T,roles:i}}function d({identities:t,policies:T}){let i={},r={},P=Object.keys(i),l=[];return T.forEach(e=>{Object.keys(e.roles).forEach(n=>{let o=`${e.name}.${n}`;r[o]=new Set;let y=e.roles[n];y==="*"?Object.keys(e.permissions).forEach(s=>{e.permissions[s].forEach(m=>{r[o].add(`${e.name}.${s}.${m}`)})}):y.forEach(s=>{if(s.endsWith(".*")){e.permissions[s.replace(".*","")].forEach(m=>{r[o].add(`${e.name}.${s.replace(".*","")}.${m}`)});return}r[o].add(`${e.name}.${s}`)})})}),Object.keys(t).forEach(e=>{i[e]={},t[e].forEach(n=>{Object.keys(n).forEach(o=>{r[n].forEach(s=>{i[e][s]=!0})})})}),{identities:P,allPermissions:l,enforce:(e,n)=>n.every(o=>i[e]!==void 0&&i[e][o]===!0)}}exports.createIdentity = d; exports.createPolicy = a;
//# sourceMappingURL=index.cjs.map